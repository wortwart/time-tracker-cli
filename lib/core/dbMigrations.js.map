{"version":3,"sources":["../../src/core/dbMigrations.js"],"names":["migrateToV2","tasks","promises","migrate","key","task","Promise","resolve","reject","timing","update","start","stop","timings","Object","keys","forEach","push","k","all"],"mappings":";;;;;AAAO,IAAMA,oCAAc,SAAdA,WAAc,CAAUC,KAAV,EAAiB;AAC3C,KAAIC,WAAW,EAAf;AACA,KAAIC,UAAU,SAAVA,OAAU,CAACC,GAAD,EAAMC,IAAN;AAAA,SAAe,IAAIC,OAAJ,CAAY,UAACC,OAAD,EAAUC,MAAV,EAAqB;AAC7D,OAAIC,SAAS,EAAb;AACA,OAAIC,SAAS,KAAb;;AAEA,OAAIL,KAAKM,KAAT,EAAgB;AACfD,aAAS,IAAT;AACAD,WAAOE,KAAP,GAAeN,KAAKM,KAApB;AACA,WAAON,KAAKM,KAAZ;AACA;;AAED,OAAIN,KAAKO,IAAT,EAAe;AACdH,WAAOG,IAAP,GAAcP,KAAKO,IAAnB;AACA,WAAOP,KAAKO,IAAZ;AACA;;AAED,OAAIF,MAAJ,EAAY;AACXL,SAAKQ,OAAL,GAAe,CAACJ,MAAD,CAAf;AACA;;AAEDF,WAAQ;AACPH,YADO;AAEPC;AAFO,IAAR;AAIA,GAvB4B,CAAf;AAAA,EAAd;;AAyBAS,QAAOC,IAAP,CAAYd,KAAZ,EAAmBe,OAAnB,CAA2B;AAAA,SAAKd,SAASe,IAAT,CAAed,QAAQe,CAAR,EAAWjB,MAAMiB,CAAN,CAAX,CAAf,CAAL;AAAA,EAA3B;AACA,QAAOZ,QAAQa,GAAR,CAAYjB,QAAZ,CAAP;AACA,CA7BM","file":"dbMigrations.js","sourcesContent":["export const migrateToV2 = function (tasks) {\n\tlet promises = []\n\tlet migrate = (key, task) => new Promise((resolve, reject) => {\n\t\tlet timing = {}\n\t\tlet update = false\n\n\t\tif (task.start) {\n\t\t\tupdate = true\n\t\t\ttiming.start = task.start\n\t\t\tdelete task.start\n\t\t}\n\n\t\tif (task.stop) {\n\t\t\ttiming.stop = task.stop\n\t\t\tdelete task.stop\n\t\t}\n\n\t\tif (update) {\n\t\t\ttask.timings = [timing]\n\t\t}\n\n\t\tresolve({\n\t\t\tkey,\n\t\t\ttask\n\t\t})\n\t})\n\n\tObject.keys(tasks).forEach(k => promises.push( migrate(k, tasks[k]) ))\n\treturn Promise.all(promises)\n}\n"]}